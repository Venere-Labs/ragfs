# cargo-deny configuration
# Run with: cargo deny check

[graph]
# Only check dependencies of default features
all-features = false

[advisories]
# Advisory database to check against
db-path = "~/.cargo/advisory-db"
db-urls = ["https://github.com/rustsec/advisory-db"]

# How to handle advisories
vulnerability = "deny"
unmaintained = "warn"
yanked = "warn"
notice = "warn"

# Ignore specific advisories (with justification)
ignore = []

[licenses]
# Ensure licenses are compatible with our dual MIT/Apache-2.0 license
unlicensed = "deny"
default = "deny"

# Allowed licenses
allow = [
    "MIT",
    "Apache-2.0",
    "Apache-2.0 WITH LLVM-exception",
    "BSD-2-Clause",
    "BSD-3-Clause",
    "ISC",
    "Zlib",
    "0BSD",
    "Unicode-DFS-2016",
    "MPL-2.0",
    "CC0-1.0",
]

# Deny copyleft licenses
copyleft = "deny"

# Allow specific crates with non-standard licenses
exceptions = []

# Clarify licenses for crates where detection fails
[[licenses.clarify]]
name = "ring"
expression = "MIT AND ISC AND OpenSSL"
license-files = [{ path = "LICENSE", hash = 0xbd0eed23 }]

[bans]
# Lint multiple versions of the same crate
multiple-versions = "warn"

# Don't allow wildcard dependencies
wildcards = "deny"

# Allow workspace dependencies
workspace-default-features = "allow"

# Don't allow build scripts to do network operations
build-script-allow-network = false

# Deny specific crates
deny = []

# Allow specific duplicate crates (when justified)
skip = []

[sources]
# Only allow crates from crates.io
unknown-registry = "deny"
unknown-git = "deny"

# Allow crates from crates.io
allow-registry = ["https://github.com/rust-lang/crates.io-index"]

# Allow specific git repos (e.g., for workspace members)
allow-git = []
